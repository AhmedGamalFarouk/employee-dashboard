// =============================================================================
// Layout Styles - Page Structure and Grid
// =============================================================================

@use 'variables' as *;

// Main Container
.app-container {
    display: flex;
    height: 100vh;
    width: 100%;
}

// =============================================================================
// Sidebar - Collapsed by Default, Expands on Hover
// =============================================================================
.sidebar {
    display: none;
    flex-direction: column;
    width: var(--sidebar-collapsed-width);
    height: 100%;
    background-color: var(--surface);
    border-right: 1px solid var(--border);
    overflow-y: auto;
    overflow-x: hidden;
    transition: $transition-sidebar;
    position: relative;
    flex-shrink: 0;

    @media (min-width: 768px) {
        display: flex;
    }

    // Collapsed state (default)
    .sidebar__title-group {
        overflow: hidden;
        transition: $transition-sidebar;
    }

    .sidebar__title {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        line-height: 1;
        padding: 0 0.25rem;
    }

    .sidebar__subtitle {
        opacity: 0;
        width: 0;
        height: 0;
        overflow: hidden;
        margin: 0;
        transition: $transition-sidebar;
    }

    .nav-item span:not(.nav-item__icon):not(.material-symbols-outlined) {
        opacity: 0;
        width: 0;
        overflow: hidden;
        white-space: nowrap;
        transition: $transition-sidebar;
    }

    .sidebar__footer .nav-item span:not(.nav-item__icon):not(.material-symbols-outlined) {
        opacity: 0;
        width: 0;
        overflow: hidden;
        transition: $transition-sidebar;
    }

    .user-profile {
        flex-direction: column;
        gap: $spacing-2;
        padding: 0;
        justify-content: center;
        align-items: center;
        transition: $transition-sidebar;
    }

    .user-profile__info {
        opacity: 0;
        width: 0;
        height: 0;
        overflow: hidden;
        transition: $transition-sidebar;
    }

    .sidebar__header {
        justify-content: center;
        padding: $spacing-4;
        transition: $transition-sidebar;
    }

    .sidebar__nav {
        padding: 0 $spacing-2;
        transition: $transition-sidebar;
    }

    .nav-item {
        justify-content: center;
        align-items: center;
        padding: 0;
        width: 2.5rem;
        height: 2.5rem;
        aspect-ratio: 1 / 1;
        gap: 0;
        transition: $transition-sidebar;
    }

    // Expanded state (on hover)
    &:hover {
        width: var(--sidebar-width);

        .sidebar__title-group {
            opacity: 1;
            width: auto;
        }

        .sidebar__title {
            flex-direction: row;
            gap: 0.35rem;
        }

        .sidebar__subtitle {
            opacity: 1;
            width: auto;
            height: auto;
            margin-top: 0.25rem;
        }

        .nav-item span:not(.nav-item__icon):not(.material-symbols-outlined) {
            opacity: 1;
            width: auto;
        }

        .sidebar__footer .nav-item span:not(.nav-item__icon):not(.material-symbols-outlined) {
            opacity: 1;
            width: auto;
        }

        .user-profile {
            flex-direction: row;
            gap: $spacing-3;
            padding-left: $spacing-2;
            padding-right: $spacing-2;
            justify-content: flex-start;
            align-items: center;
        }

        .user-profile__info {
            opacity: 1;
            width: auto;
            height: auto;
        }

        .sidebar__header {
            justify-content: space-between;
            padding: $spacing-6;
        }

        .sidebar__nav {
            padding: 0 $spacing-4;
        }

        .nav-item {
            justify-content: flex-start;
            padding: $spacing-3 $spacing-4;
            width: auto;
            height: auto;
            aspect-ratio: auto;
            gap: $spacing-3;
        }

        .sidebar__lock-btn {
            opacity: 1;
            pointer-events: all;
        }
    }

    // Locked state - stays expanded
    &.sidebar--locked {
        width: var(--sidebar-width);

        .sidebar__title-group {
            opacity: 1;
            width: auto;
        }

        .sidebar__title {
            flex-direction: row;
            gap: 0.35rem;
        }

        .sidebar__subtitle {
            opacity: 1;
            width: auto;
            height: auto;
            margin-top: 0.25rem;
        }

        .nav-item span:not(.nav-item__icon):not(.material-symbols-outlined) {
            opacity: 1;
            width: auto;
        }

        .sidebar__footer .nav-item span:not(.nav-item__icon):not(.material-symbols-outlined) {
            opacity: 1;
            width: auto;
        }

        .user-profile {
            flex-direction: row;
            gap: $spacing-3;
            padding-left: $spacing-2;
            padding-right: $spacing-2;
            justify-content: flex-start;
            align-items: center;
        }

        .user-profile__info {
            opacity: 1;
            width: auto;
            height: auto;
        }

        .sidebar__header {
            justify-content: space-between;
            padding: $spacing-6;
        }

        .sidebar__nav {
            padding: 0 $spacing-4;
        }

        .nav-item {
            justify-content: flex-start;
            padding: $spacing-3 $spacing-4;
            width: auto;
            height: auto;
            aspect-ratio: auto;
            gap: $spacing-3;
        }

        .sidebar__lock-btn {
            opacity: 1;
            pointer-events: all;
            color: var(--primary);
        }
    }
}

.sidebar__header {
    padding: $spacing-6;
    display: flex;
    align-items: center;
    gap: $spacing-3;
    transition: $transition-sidebar;
    justify-content: space-between;
}

.sidebar__lock-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2rem;
    height: 2rem;
    border-radius: $border-radius-md;
    background: transparent;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s;
    flex-shrink: 0;
    opacity: 0;
    pointer-events: none;

    .material-symbols-outlined {
        font-size: 1.25rem;
    }

    &:hover {
        background: var(--border);
        color: var(--primary);
    }
}

.sidebar__title-group {
    display: flex;
    flex-direction: column;
    transition: $transition-sidebar;
    overflow: hidden;
}

.sidebar__title {
    font-size: 1.25rem;
    font-weight: 700;
    line-height: 1.2;
    letter-spacing: -0.025em;
    white-space: nowrap;
}

.sidebar__subtitle {
    color: var(--text-muted);
    font-size: 0.75rem;
    font-weight: 500;
    white-space: nowrap;
}

// Navigation
.sidebar__nav {
    display: flex;
    flex-direction: column;
    gap: $spacing-2;
    padding: 0 $spacing-4;
    margin-top: $spacing-4;
    transition: $transition-sidebar;
}

.nav-item {
    display: flex;
    align-items: center;
    gap: $spacing-3;
    padding: $spacing-3 $spacing-4;
    border-radius: $border-radius-full;
    font-size: 0.875rem;
    font-weight: 500;
    transition: $transition-sidebar;
    white-space: nowrap;

    &:hover {
        background-color: var(--border);
    }

    &:hover .nav-item__icon {
        color: var(--primary);
    }

    &--active {
        background-color: var(--primary);
        color: var(--background);
        font-weight: 700;
        box-shadow: var(--shadow-primary);

        .nav-item__icon {
            color: var(--background);
        }

        &:hover {
            background-color: var(--primary);
        }
    }

    span:not(.nav-item__icon):not(.material-symbols-outlined) {
        transition: $transition-sidebar;
    }
}

.nav-item__icon {
    color: var(--text-muted);
    font-size: 1.5rem;
    transition: $transition-colors;
    min-width: 1.5rem;
}

// Sidebar Footer
.sidebar__footer {
    margin-top: auto;
    padding: $spacing-4;
    margin-bottom: $spacing-4;
    transition: $transition-sidebar;
}

.user-profile {
    margin-top: $spacing-4;
    padding-top: $spacing-4;
    border-top: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: $spacing-3;
    padding-left: $spacing-2;
    padding-right: $spacing-2;
    transition: $transition-sidebar;
}

.user-profile__avatar {
    width: 2.5rem;
    height: 2.5rem;
    min-width: 2.5rem;
    border-radius: $border-radius-full;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    border: 2px solid var(--primary);
    flex-shrink: 0;
}

.user-profile__info {
    display: flex;
    flex-direction: column;
    overflow: hidden;
    transition: $transition-sidebar;
}

.user-profile__name {
    font-size: 0.875rem;
    font-weight: 700;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.user-profile__email {
    font-size: 0.75rem;
    color: var(--text-muted);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

// Main Content
.main-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    height: 100%;
    position: relative;
    overflow-y: auto; // Allow scrolling
    transition: $transition-sidebar;
}

// =============================================================================
// Header
// =============================================================================
.header {
    height: 7rem;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: $spacing-4 $spacing-6;
    background-color: var(--surface);
    backdrop-filter: blur(8px);
    border-bottom: 1px solid var(--border);
    z-index: 10;
    transition: background-color 0.3s ease;
    position: sticky; // Make header sticky
    top: 0;
}

.header__top {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: $spacing-4;
}

.header__left {
    display: flex;
    align-items: center;
    gap: $spacing-4;
}

.header__mobile-menu {
    display: block;
    padding: $spacing-2;
    color: var(--text-muted);

    &:hover {
        color: var(--primary);
    }

    @media (min-width: 768px) {
        display: none;
    }
}

.header__title {
    display: none;
    font-size: 1.125rem;
    font-weight: 700;
    letter-spacing: -0.025em;

    @media (min-width: 640px) {
        display: block;
    }
}

.header__actions {
    display: flex;
    align-items: center;
    gap: $spacing-4;
}

.header__icon-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2.5rem;
    height: 2.5rem;
    border-radius: $border-radius-full;
    color: var(--text-muted);
    transition: $transition-colors;
    position: relative;
    margin-right: $spacing-2;

    &:hover {
        background-color: var(--border);
        color: var(--primary);
    }
}

.header__notification-dot {
    position: absolute;
    top: 0.5rem;
    right: 0.5rem;
    width: 0.5rem;
    height: 0.5rem;
    background-color: var(--primary);
    border-radius: $border-radius-full;
}

// =============================================================================
// Theme Toggle Button
// =============================================================================
.theme-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2.5rem;
    height: 2.5rem;
    border-radius: $border-radius-full;
    color: var(--text-muted);
    transition: $transition-all;
    position: relative;
    margin-right: $spacing-2;
    cursor: pointer;
    background: transparent;
    border: none;

    &:hover {
        background-color: var(--border);
        color: var(--primary);
    }

    .material-symbols-outlined {
        font-size: 1.5rem;
        transition: $transition-all;
    }

    // Sun icon (for dark mode - click to go light)
    .theme-toggle__sun {
        display: none;
    }

    // Moon icon (for light mode - click to go dark)
    .theme-toggle__moon {
        display: block;
    }
}

// Show correct icon based on theme
:root[data-theme="light"] .theme-toggle {
    .theme-toggle__sun {
        display: none;
    }

    .theme-toggle__moon {
        display: block;
    }
}

:root:not([data-theme="light"]) .theme-toggle {
    .theme-toggle__sun {
        display: block;
    }

    .theme-toggle__moon {
        display: none;
    }
}

// Search and Filters
.header__search-row {
    display: flex;
    flex-direction: column;
    gap: $spacing-4;
    width: 100%;

    @media (min-width: 640px) {
        flex-direction: row;
    }
}

.search-box {
    width: 100%;
    max-width: 320px;
    position: relative;
}

.search-box__icon {
    position: absolute;
    left: $spacing-4;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-muted);
    pointer-events: none;
}

.search-box__input {
    display: block;
    width: 100%;
    height: 2.5rem;
    padding-left: 2.75rem;
    padding-right: $spacing-4;
    border-radius: $border-radius-full;
    background-color: var(--background);
    border: 1px solid var(--border);
    color: var(--text);
    font-size: 0.875rem;
    transition: $transition-all;

    &::placeholder {
        color: var(--text-muted);
        opacity: 0.8;
    }

    &:focus {
        border-color: var(--primary);
    }
}


// Content Area
.content-area {
    flex: 1;
    overflow-y: auto;
    padding: $spacing-4;

    @media (min-width: 768px) {
        padding: $spacing-8;
    }
}

.content-wrapper {
    max-width: 87.5rem;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: $spacing-6;
}

// Page Header
.page-header {
    display: flex;
    flex-direction: column;
    gap: $spacing-4;

    @media (min-width: 768px) {
        flex-direction: row;
        align-items: flex-end;
        justify-content: space-between;
    }
}

.page-header__text {
    display: flex;
    flex-direction: column;
    gap: $spacing-1;
}

.page-header__title {
    font-size: 1.875rem;
    font-weight: 900;
    letter-spacing: -0.025em;
    color: var(--text);
}

.page-header__subtitle {
    color: var(--text-muted);
}


.page-header__actions {
    display: flex;
    align-items: center;
    gap: $spacing-3;
    flex-wrap: wrap;
}

// Pagination
.pagination {
    padding: $spacing-4;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.pagination__info {
    font-size: 0.875rem;
    color: var(--text-muted);
}

.pagination__highlight {
    font-weight: 700;
    color: var(--text);
}

.pagination__controls {
    display: flex;
    gap: $spacing-2;
}